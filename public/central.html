<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=0.5"/>
  <title>GoldLinc Result Checker</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
html, body {
  font-family: 'Roboto', sans-serif;
  background: linear-gradient(160deg, #000e30, #00153d);
  min-height: 100vh;
  margin: 0;
  padding: 10px 10px; /* add space around the container */
  display: block; /* remove flex */
  overflow-x: hidden;
  overflow-y: auto;
      }
  

  /* Add styles for the generated result section */
  #studentInfo {
    margin-top: 30px;
    padding: 20px;
    background: rgba(0, 0, 0, 0.6); /* Dark background for better readability */
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    color: #fff;
    text-align: left;
    animation: fadeIn 0.5s ease-in-out;
  }
  
  #studentInfo h3 {
    margin-bottom: 20px;
    font-size: 18px;
    color: #00ffa6;
    text-align: center;
  }

  #studentInfo table {
    margin-top: 15px;
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  #studentInfo p {
    margin: 10px 0;
    line-height: 1.6;
    font-size: 12px;
  }

  #studentInfo img {
    display: block;
    margin: 20px auto;
    border-radius: 8px;
  }



  .container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 16px;
    padding: 40px 30px;
    max-width: 900px; /* Increased max width for larger screens */
    width: 100%;
    margin: 0 auto; /* Center horizontally */
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.4);
    color: #fff;
    text-align: center;
    animation: fadeIn 1s ease-in-out;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .container {
      max-width: 700px; /* Maintain smaller width on medium screens */
      padding: 30px 20px; /* Adjust padding for smaller screens */
    }
  }

  @media (max-width: 480px) {
    .container {
      max-width: 100%; /* Full width for mobile devices */
      padding: 20px 15px; /* Further reduce padding */
    }
  }


    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .logo img {
      width: 80px;
      margin-bottom: 15px;
      animation: dropIn 1.2s ease;
    }

    @keyframes dropIn {
      0% { transform: translateY(-60px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    .school-details {
      font-size: 14px;
      color: #e0e0e0;
      margin-bottom: 25px;
      line-height: 1.5;
    }

    .school-details strong {
      font-size: 16px;
      color: #00ffa6;
      display: block;
      margin-bottom: 4px;
    }

    .school-details a {
      color: #00ffd0;
      text-decoration: none;
    }

    .school-details a:hover {
      text-decoration: underline;
    }

    h2 {
      font-weight: 700;
      margin-bottom: 10px;
      color: #ffffff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.6);
    }
    
    label {
      display: block;
      text-align: left;
      font-size: 14px;
      color: #c0c0c0;
      margin-top: 20px;
      margin-bottom: 5px;
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      color: #fff;
      transition: all 0.3s ease;
    }

    input:focus {
      border-color: #00ffa6;
      outline: none;
      box-shadow: 0 0 8px rgba(0, 255, 166, 0.5);
      background: rgba(255,255,255,0.15);
    }

    button {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      background: linear-gradient(90deg, #00ffa6, #00ffd0);
      color: #000;
      font-weight: bold;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    button:hover {
      transform: translateY(-2px);
    }

    footer {
      margin-top: 30px;
      font-size: 12px;
      color: #aaa;
    }
    .result-details {
  padding: 20px 30px; /* Unique padding */
  margin-top: 20px; /* Add some spacing above */
      margin-bottom: 10px; /* Add some spacing above */
  background: blue; /* Optional: subtle background for contrast */
  border-radius: 10px; /* Optional: rounded corners */
  color: #fff; /* Text color */
  font-size: 14px; /* Adjust font size */
  line-height: 1.6; /* Improve readability */
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="logo">
      <img src="logo-1679575828.jpeg" alt="JAMB Logo">
    </div>

    <div class="school-details">
      <strong>GOLD AND LINC SCHOOLS</strong>
      Behind Irenitemi Hotel, Testing Ground Area,<br/>
      Off Osogbo Road, Ilesa.<br/>
      Phone: <a href="tel:08034430941">08034430941</a><br/>
      Website: <a href="https://goldlincschools.com" target="_blank">goldlincschools.com</a><br/>
      Email: <a href="mailto:goldlincschools@gmail.com">goldlincschools@gmail.com</a>
    </div>

    <h2>CENTRAL RESULT CHECKING PORTAL</h2>

    <form id="resultForm">
      <label for="regNumber">Reg Number / GSM No.</label>
      <input type="text" id="regNumber" placeholder="Enter Reg Number or GSM No." required>

      <label for="scratchCard">Scratch Card PIN</label>
      <input type="password" id="scratchCard" placeholder="Enter your scratch card PIN" required>

      <button type="submit">
        <span>Check My Results</span> 
        <span>✔️</span>
      </button>
    </form>
<div id="studentInfo">
    <!-- Retrieved student data will be displayed here -->
</div>
    <footer>
      &copy; 2025. Gold and Linc Schools, All Rights Reserved 
    </footer>
  </div>
<!-- ...your HTML up to the script tag remains the same... -->
<script>
document.getElementById("resultForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const regNumber = document.getElementById("regNumber").value.trim();
  const scratchCard = document.getElementById("scratchCard").value.trim();

  if (!regNumber || !scratchCard) {
    alert("Please enter both Reg Number and Scratch Card PIN.");
    return;
  }

  // Prompt for class, session, term
  let className = prompt("Enter your class (e.g., JSS1, SS2) exactly as registered:");
  if (!className) {
    alert("Class is required.");
    return;
  }
  let session = prompt("Enter the session (e.g., 2024–2025):");
  if (!session) {
    alert("Session is required.");
    return;
  }
  let term = prompt("Enter the term (e.g., FIRST TERM, SECOND TERM, THIRD TERM):");
  if (!term) {
    alert("Term is required.");
    return;
  }

  // Call backend API
  fetch(`/api/results/check?regNo=${encodeURIComponent(regNumber)}&scratchCard=${encodeURIComponent(scratchCard)}&class=${encodeURIComponent(className)}&session=${encodeURIComponent(session)}&term=${encodeURIComponent(term)}`)
    .then(response => response.json())
    .then(data => {
      if (data.error) {
        alert(data.error);
        document.getElementById("studentInfo").innerHTML = "";
        return;
      }
      displayFullReportFromAPI(data);
    })
    .catch(error => {
      console.error("Error fetching results:", error);
      alert("Error loading student data.");
    });
});

function displayFullReportFromAPI(data) {
  const student = data.student || {};
  const results = data.results || [];
  const classSize = data.classSize || "";
  const skills = (data.skillsReport && data.skillsReport.skillsAndTraits) ? data.skillsReport.skillsAndTraits : [];
  const attendance = (data.skillsReport && data.skillsReport.attendance) ? data.skillsReport.attendance : [];
  const principalComment = (data.skillsReport && data.skillsReport.principalComment) || "";
  const principalName = (data.skillsReport && data.skillsReport.principalName) || "";
  const nextTermBegins = (data.skillsReport && data.skillsReport.nextTermBegins) || "";
  const datePrinted = new Date().toLocaleString();

  const subjectsHTML = results.map(subj => `
    <tr>
      <td>${subj.subject}</td>
      <td>${subj.ca1_score ?? ''}</td>
      <td>${subj.midterm_score ?? ''}</td>
      <td>${subj.exam_score ?? ''}</td>
      <td>${subj.total ?? ''}</td>
      <td>${subj.grade ?? ''}</td>
      <td>${subj.remark ?? ''}</td>
    </tr>
  `).join('');

  const skillsHTML = skills.map(skill => `
    <tr>
      <td>${skill.skill || skill.name || ''}</td>
      <td>${skill.level || skill.score || ''}</td>
    </tr>
  `).join('');

  const attendanceHTML = attendance.length
    ? attendance.map(a => `<tr><td>${a.label}</td><td>${a.value}</td></tr>`).join('')
    : '<tr><td colspan="2">No attendance data</td></tr>';

  const gradeKeyHTML = `
    <tr><td>A</td><td>70 - 100</td><td>Excellent</td></tr>
    <tr><td>B</td><td>60 - 69</td><td>Very Good</td></tr>
    <tr><td>C</td><td>50 - 59</td><td>Good</td></tr>
    <tr><td>D</td><td>45 - 49</td><td>Fair</td></tr>
    <tr><td>E</td><td>40 - 44</td><td>Poor</td></tr>
    <tr><td>F</td><td>0 - 39</td><td>Fail</td></tr>
  `;

  // Calculate total, GPA, etc if not present
  let totalScore = 0, totalGradePoints = 0, subjectCount = 0;
  results.forEach(r => {
    if (r.total) totalScore += Number(r.total) || 0;
    if (r.grade_point) totalGradePoints += Number(r.grade_point) || 0;
    subjectCount++;
  });
  const gpa = subjectCount ? (totalGradePoints / subjectCount).toFixed(2) : "";
  const performanceGrade = (() => {
    const avg = subjectCount ? (totalScore / subjectCount) : 0;
    if (avg >= 70) return "A (Excellent)";
    if (avg >= 60) return "B (Very Good)";
    if (avg >= 50) return "C (Good)";
    if (avg >= 45) return "D (Fair)";
    if (avg >= 40) return "E (Poor)";
    return "F (Fail)";
  })();

  const resultHTML = `
  <div class="result-details">
    <h3>Result for ${student.name || ''}</h3>
    <p><strong>Reg No.:</strong> ${student.regNo || ''} &nbsp; <strong>Gender:</strong> ${student.gender || ''} &nbsp; <strong>Age:</strong> ${student.age || ''}</p>
    <p><strong>Class:</strong> ${student.class || ''} &nbsp; <strong>Session:</strong> ${student.session || ''}</p>
    <p><strong>Performance Grade:</strong> ${performanceGrade} &nbsp; <strong>GPA:</strong> ${gpa} &nbsp; <strong>Total Score:</strong> ${totalScore}</p>
    <p><strong>Class Size:</strong> ${classSize}</p>
  </div>

      <h4>Subjects</h4>
      <table border="1" cellpadding="6" cellspacing="0" style="width: 100%; border-collapse: collapse; color: white;">
        <thead>
          <tr>
            <th>Subject</th>
            <th>1st CA</th>
            <th>Mid-Term</th>
            <th>Exam</th>
            <th>Total</th>
            <th>Grade</th>
            <th>Remark</th>
          </tr>
        </thead>
        <tbody>
          ${subjectsHTML}
        </tbody>
      </table>

      <h4>Skills and Traits</h4>
      <table border="1" cellpadding="6" cellspacing="0" style="width: 100%; border-collapse: collapse; color: white;">
        <thead>
          <tr><th>Skill</th><th>Level</th></tr>
        </thead>
        <tbody>
          ${skillsHTML}
        </tbody>
      </table>

      <h4>Attendance</h4>
      <table border="1" cellpadding="6" cellspacing="0" style="width: 100%; border-collapse: collapse; color: white;">
        <tbody>
          ${attendanceHTML}
        </tbody>
      </table>

      <h4>Grade Key</h4>
      <table border="1" cellpadding="6" cellspacing="0" style="width: 100%; border-collapse: collapse; color: white;">
        <thead>
          <tr><th>Key</th><th>Score Range</th><th>Remark</th></tr>
        </thead>
        <tbody>
          ${gradeKeyHTML}
        </tbody>
      </table>

      <h4>Principal’s Comment</h4>
      <p style="color: #00ffd0;"><em>${principalComment}</em></p>
      <p><strong>Principal:</strong> ${principalName}</p>
      <p><strong>Next Term Begins:</strong> ${nextTermBegins}</p>
      <p><strong>Date Printed:</strong> ${datePrinted}</p>

      <!-- Add the notification -->
      <p style="color: red; font-weight: bold; text-align: center; margin-top: 20px;">
        NOTE: YOU ARE TO VIEW AND PRINT OUT THE ORIGINAL COPY DIRECTLY FROM YOUR PORTAL, KINDLY LOG IN TO DO THAT.
      </p>

      <!-- Add the login button -->
      <div style="text-align: center; margin-top: 15px;">
        <button style="
          background-color: #ff4d4d;
          color: white;
          font-size: 16px;
          font-weight: bold;
          padding: 10px 20px;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: background-color 0.3s ease;
        " onclick="window.location.href='login';">
          Login to Portal
        </button>
      </div>
    `;

  document.getElementById("studentInfo").innerHTML = resultHTML;
}
</script>
</body>
</html>
