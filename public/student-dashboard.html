<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard | Gold and Linc Schools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    :root {
      --primary: #175b9c;
      --accent: #17c3b2;
      --bg: #f4f8fc;
      --card: #fff;
      --radius: 22px;
      --shadow: 0 6px 26px 0 rgba(30, 80, 180, 0.12);
      --shadow-hover: 0 10px 40px 0 rgba(30, 80, 180, 0.16);
      --text-main: #17223a;
      --text-muted: #889;
      --transition: 0.19s cubic-bezier(.39,.58,.57,1.01);
      --header-height: 92px;
    }
    html, body {
      margin: 0; padding: 0;
      background: linear-gradient(110deg, #eaf6ff 0%, #f4f8fc 100%);
      font-family: 'Inter', Arial, sans-serif;
      color: var(--text-main);
      min-height: 100vh;
      scroll-behavior: smooth;
    }
    body {
      box-sizing: border-box;
    }
    /* Header */
    header {
      background: linear-gradient(100deg, #175b9c 75%, #17c3b2 100%);
      color: #fff;
      min-height: var(--header-height);
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 3px 20px rgba(30,80,180,0.14);
      position: sticky;
      top: 0; z-index: 40;
      border-bottom-left-radius: 28px;
      border-bottom-right-radius: 28px;
      animation: headerDrop 0.7s cubic-bezier(.7,.2,.4,1.1);
    }
    @keyframes headerDrop {
      from { transform: translateY(-45px); opacity: 0.5;}
      to { transform: translateY(0); opacity: 1;}
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 17px;
      margin-left: 32px;
    }
    .header-logo {
      width: 60px; height: 60px; border-radius: 18px;
      background: #fff;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 11px rgba(23,91,156,0.13);
      overflow: hidden;
    }
    .header-logo img {
      width: 48px; height: 48px;
    }
    .header-title {
      font-weight: 900;
      font-size: 1.32rem;
      letter-spacing: 2px;
      font-family: inherit;
      color: #fff;
      text-shadow: 0 1px 6px rgba(23,91,156,0.09);
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 26px;
      margin-right: 36px;
    }
    .header-actions .icon {
      font-size: 1.25rem;
      color: #bff0ff;
      cursor: pointer;
      transition: color var(--transition), transform var(--transition);
      padding: 5px 0;
    }
    .header-actions .icon:hover { color: #fff; transform: scale(1.15);}
    /* Profile Card */
    .profile-card {
      background: var(--card);
      margin: -52px auto 34px auto;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 36px 40px 27px 40px;
      max-width: 600px;
      position: relative;
      text-align: center;
      z-index: 11;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow var(--transition), transform var(--transition);
      animation: cardPop 0.7s cubic-bezier(.7,.2,.4,1.1);
    }
    .profile-card:hover {
      box-shadow: var(--shadow-hover);
      transform: scale(1.02) translateY(-2px);
    }
    @keyframes cardPop {
      from { opacity:0; transform: scale(.92);}
      to { opacity:1; transform: scale(1);}
    }
    .profile-avatar {
      width: 95px; height: 95px;
      border-radius: 50%;
      border: 3.5px solid var(--accent);
      object-fit: cover;
      background: #eaf2fb;
      margin-bottom: 8px;
      box-shadow: 0 2px 16px rgba(23,91,156,0.11);
      transition: border .2s;
    }
    .profile-name {
      font-size: 1.36rem;
      font-weight: 800;
      margin-bottom: 2px;
      letter-spacing: 0.6px;
      color: var(--primary);
      text-shadow: 0 1px 0 #eaf6f9;
    }
    .profile-meta {
      color: var(--text-muted);
      font-size: 1.02rem;
      margin-bottom: 12px;
    }
    .profile-details {
      display: flex;
      justify-content: center;
      gap: 28px;
      font-size: 1.01rem;
      color: #567;
      margin-bottom: 3px;
    }
    .profile-details span { opacity: 0.84; }
    /* Dashboard Layout */
    .dashboard-main {
      max-width: 1250px;
      margin: 0 auto;
      display: flex;
      gap: 38px;
      padding: 0 2vw;
      flex-wrap: wrap;
    }
    .main-left { flex: 2.3; min-width: 340px; }
    .main-right { flex: 1.1; min-width: 255px; }
    /* Timetable */
    .timetable-card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px 28px 14px 28px;
      margin-bottom: 23px;
      font-size: 1.13rem;
      transition: box-shadow var(--transition), transform var(--transition);
      animation: fadeInCard 0.8s cubic-bezier(.7,.2,.4,1.1);
    }
    .timetable-card:hover { box-shadow: var(--shadow-hover); transform: scale(1.01);}
    .timetable-title { color: var(--primary); font-weight: 700; margin-bottom: 9px; font-size: 1.13rem;}
    .timetable-summary {
      margin-bottom: 8px;
      border-radius: 9px;
      background: #eaf6ff;
      padding: 8px 15px;
      color: #245;
      font-size: 1.04rem;
      box-shadow: 0 1px 5px rgba(30,50,90,0.05);
    }
    .see-all-link {
      color: var(--primary);
      font-size:0.98rem;
      text-decoration: underline;
      transition: color var(--transition);
      border-radius: 5px;
      padding: 1px 6px;
      font-weight: 500;
    }
    .see-all-link:hover { color: var(--accent); background: #eaf6ff;}
    /* Quick Access Cards */
    .quick-cards {
      display: grid;
      gap: 22px;
      grid-template-columns: repeat(auto-fit, minmax(182px, 1fr));
      margin-bottom: 28px;
    }
    .quick-card {
      background: linear-gradient(140deg, #fff 88%, #d4edfa 100%);
      border-radius: 15px;
      box-shadow: 0 1px 11px rgba(30,50,90,0.10);
      padding: 24px 17px 17px 19px;
      display: flex;
      flex-direction: column;
      cursor: pointer;
      transition: box-shadow var(--transition), transform var(--transition);
      position: relative;
      min-height: 94px;
      overflow: hidden;
      border: 2px solid transparent;
    }
    .quick-card:hover {
      box-shadow: var(--shadow-hover);
      border: 2px solid #17c3b2;
      transform: translateY(-2px) scale(1.029);
    }
    .quick-card .q-icon {
      font-size: 1.59rem;
      color: var(--primary);
      margin-bottom: 12px;
      opacity: 0.96;
      filter: drop-shadow(0 2px 8px #eaf6ff);
      transition: color var(--transition), filter var(--transition);
    }
    .quick-card:hover .q-icon { color: var(--accent); filter: drop-shadow(0 3px 15px #a0eaf8);}
    .quick-card .q-title {
      font-weight: 800;
      font-size: 1.13rem;
      margin-bottom: 1px;
      color: #175b9c;
      letter-spacing: 0.2px;
      text-shadow: 0 1px 0 #eaf6f9;
    }
    .quick-card .q-desc {
      font-size: 1.02rem;
      color: #678;
      opacity: 0.92;
      margin-bottom: 4px;
      font-weight: 600;
      letter-spacing: 0.01em;
    }
    .quick-card .q-badge {
      position: absolute;
      top: 7px; right: 13px;
      background: #f55;
      color: #fff;
      border-radius: 9px;
      font-size: 0.85rem;
      padding: 2px 9px;
      font-weight: 800;
      display: none;
    }
    /* News & Updates */
    .news-card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px 18px 16px 18px;
      margin-bottom: 34px;
      animation: fadeInCard 1.1s cubic-bezier(.7,.2,.4,1.08);
      transition: box-shadow var(--transition), transform var(--transition);
    }
    .news-card:hover { box-shadow: var(--shadow-hover); }
    @keyframes fadeInCard {
      from { opacity:0; transform: translateY(25px);}
      to { opacity:1; transform: translateY(0);}
    }
    .news-title {
      color: #175b9c;
      font-weight: 900;
      margin-bottom: 14px;
      font-size: 1.14rem;
      letter-spacing: 0.03em;
    }
    .news-empty {
      color: #888;
      font-size: 1rem;
      margin-bottom: 8px;
      text-align: center;
      padding: 12px 0 4px 0;
      opacity: 0.8;
    }
    .news-item {
      background: #eaf6ff;
      border-radius: 8px;
      padding: 10px 14px 9px 14px;
      margin-bottom: 11px;
      box-shadow: 0 1px 8px rgba(30,80,180,0.07);
      font-size: 1.04rem;
      transition: background var(--transition);
    }
    .news-item strong { color: var(--primary);}
    .news-item:hover { background: #f4f8fc;}
    .news-btn {
      background: linear-gradient(90deg, #eaf6fc 60%, #d5eafc 100%);
      border: none;
      color: #175b9c;
      font-size: 1.01rem;
      font-weight: 800;
      border-radius: 7px;
      padding: 9px 32px;
      cursor: pointer;
      margin: 2px auto 0 auto;
      display: block;
      transition: background var(--transition), color var(--transition), box-shadow var(--transition);
      box-shadow: 0 1px 6px rgba(30,80,180,0.07);
      letter-spacing: 0.02em;
    }
    .news-btn:hover { background: #17c3b2; color: #fff; box-shadow: 0 2px 16px #b2e9f4;}
    /* Main right (E-Class summary, etc) */
    .panel-card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px 17px 17px 17px;
      margin-bottom: 29px;
      animation: fadeInCard 1.2s cubic-bezier(.7,.2,.4,1.1);
      transition: box-shadow var(--transition), transform var(--transition);
    }
    .panel-card:hover { box-shadow: var(--shadow-hover);}
    .panel-title {
      color: #175b9c;
      font-weight: 800;
      font-size: 1.12rem;
      margin-bottom: 13px;
      letter-spacing: 0.02em;
    }
    .panel-list {
      list-style: none;
      padding: 0;
      margin: 0;
      color: #445;
      font-size: 1.01rem;
    }
    .panel-list li {
      margin-bottom: 11px;
      display: flex;
      align-items: center;
      gap: 11px;
      font-weight: 500;
    }
    .panel-list .dot {
      width: 9px; height: 9px; border-radius: 50%; background: #17c3b2; display: inline-block;
      box-shadow: 0 2px 7px #d4fff7;
    }
    /* Floating action button */
    #eclass-fab {
      position:fixed;
      right:22px;bottom:22px;
      background: linear-gradient(90deg,#17c3b2 80%, #175b9c 100%);
      color: #fff;
      border: none;
      border-radius: 50%;
      width:59px;height:59px;
      font-size:2.05rem;
      box-shadow:0 7px 24px rgba(30,80,180,0.21);
      display:none;
      z-index:99;
      transition: background var(--transition), box-shadow var(--transition), transform var(--transition);
    }
    #eclass-fab:hover { background: #175b9c; box-shadow: 0 7px 42px #17c3b299; transform: scale(1.08);}
    /* Responsive */
    @media (max-width: 1250px) {
      .dashboard-main { max-width: 99vw; }
    }
    @media (max-width: 1100px) {
      .dashboard-main { flex-direction: column; gap: 0;}
      .main-left, .main-right { min-width: unset; }
      .main-right {margin-top: 18px;}
    }
    @media (max-width: 700px) {
      .dashboard-main { padding: 0 1vw; }
      .quick-cards { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 11px; }
      .profile-card { padding: 20px 6vw 13px 6vw; }
      .main-right { margin-top: 12px; }
      .panel-card { margin-bottom: 14px; }
      .timetable-card, .news-card { padding: 15px 3vw 10px 4vw;}
    }
    @media (max-width: 500px) {
      .profile-card { padding: 11px 2vw 7px 2vw; }
      .news-card { padding: 13px 3vw 8px 3vw; }
      .quick-card { padding: 10px 6px 8px 7px; }
      .main-right { margin-top: 6px; }
      .timetable-card { padding: 10px 2vw 5px 2vw;}
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <div class="header-logo">
        <img src="https://goldlincschools.com/assets/media/logos/favicon.ico" alt="Logo">
      </div>
      <div class="header-title">GOLD AND LINC SCHOOLS</div>
    </div>
    <div class="header-actions">
      <span class="icon" title="Notifications"><i class="fa fa-bell"></i></span>
      <span class="icon" title="Support"><i class="fa fa-question-circle"></i></span>
      <span class="icon" title="Search"><i class="fa fa-search"></i></span>
      <span class="icon" title="Menu"><i class="fa fa-bars"></i></span>
    </div>
  </header>
  <!-- Profile summary (filled by JS) -->
  <div class="profile-card" id="profileCard">
    <img class="profile-avatar" id="profileAvatar" src="https://ui-avatars.com/api/?name=Student&background=17c3b2&color=fff" alt="Student Avatar">
    <div class="profile-name" id="profileName">Student Name</div>
    <div class="profile-meta" id="profileMeta">Registration No: -</div>
    <div class="profile-details" id="profileDetails">
      <span>Class: -</span>
      <span>Session: -</span>
      <span>Term: -</span>
    </div>
  </div>
  <div class="dashboard-main">
    <!-- Left Column -->
    <div class="main-left">
      <!-- Timetable (filled by JS) -->
      <div class="timetable-card" id="timetableCard">
        <div class="timetable-title">Today's Schedule</div>
        <div class="timetable-summary" id="timetableSummary"><strong>Loading...</strong></div>
        <div style="margin-top:7px;">
          <a href="#" class="see-all-link">See all Weekdays →</a>
        </div>
      </div>
      <!-- Quick Access Cards -->
      <div class="quick-cards">
        <div class="quick-card" onclick="window.location.href='e-class.html'">
          <span class="q-icon"><i class="fa fa-laptop"></i></span>
          <span class="q-title">E-Class</span>
          <span class="q-desc">My Classrooms</span>
        </div>
        <div class="quick-card" onclick="window.location.href='assignments.html'">
          <span class="q-icon"><i class="fa fa-file-alt"></i></span>
          <span class="q-title">Assignments</span>
          <span class="q-desc">Assignments &amp; Exercises</span>
        </div>
        <div class="quick-card" onclick="window.location.href='fees.html'">
          <span class="q-icon"><i class="fa fa-wallet"></i></span>
          <span class="q-title">My Fees</span>
          <span class="q-desc">Unpaid Invoices</span>
        </div>
        <div class="quick-card" onclick="window.location.href='results.html'">
          <span class="q-icon"><i class="fa fa-chart-bar"></i></span>
          <span class="q-title">Results</span>
          <span class="q-desc">My Reports</span>
        </div>
        <div class="quick-card" onclick="window.location.href='communication.html'">
          <span class="q-icon"><i class="fa fa-comments"></i></span>
          <span class="q-title">Communication</span>
          <span class="q-desc">Messages</span>
        </div>
        <div class="quick-card" onclick="window.location.href='exams.html'">
          <span class="q-icon"><i class="fa fa-clipboard-list"></i></span>
          <span class="q-title">Exams</span>
          <span class="q-desc">Upcoming Exams</span>
        </div>
        <div class="quick-card" onclick="window.location.href='subjects.html'">
          <span class="q-icon"><i class="fa fa-book"></i></span>
          <span class="q-title">Subjects</span>
          <span class="q-desc">My Subjects</span>
        </div>
        <div class="quick-card" onclick="window.location.href='hostel.html'">
          <span class="q-icon"><i class="fa fa-bed"></i></span>
          <span class="q-title">Hostel</span>
          <span class="q-desc">Allocation</span>
        </div>
        <div class="quick-card" onclick="window.location.href='transport.html'">
          <span class="q-icon"><i class="fa fa-bus"></i></span>
          <span class="q-title">Transport</span>
          <span class="q-desc">My Subscription</span>
        </div>
        <div class="quick-card" onclick="window.location.href='profile.html'">
          <span class="q-icon"><i class="fa fa-user"></i></span>
          <span class="q-title">Profile</span>
          <span class="q-desc">View / Update</span>
        </div>
      </div>
      <!-- News & Updates -->
      <div class="news-card" id="newsCard">
        <div class="news-title">News &amp; Updates</div>
        <div class="news-empty" id="newsContent">No items found</div>
        <button class="news-btn">News &amp; Events →</button>
      </div>
    </div>
    <!-- Right Column -->
    <div class="main-right">
      <div class="panel-card" id="eclassPanel">
        <div class="panel-title">E-Class</div>
        <ul class="panel-list" id="eclassSummary">
          <li><span class="dot"></span> My Classrooms</li>
          <li><span class="dot"></span> Unread messages</li>
          <li><span class="dot"></span> Happening now</li>
        </ul>
      </div>
      <!-- Add more panels as needed -->
    </div>
  </div>
  <!-- Floating eClass button (mobile) -->
  <button id="eclass-fab" onclick="window.location.href='e-class.html'">
    <i class="fa fa-laptop"></i>
  </button>
  <script>
    // Responsive FAB button for mobile
    function updateFAB() {
      const fab = document.getElementById('eclass-fab');
      fab.style.display = window.innerWidth < 700 ? 'block' : 'none';
    }
    window.addEventListener('resize', updateFAB);
    window.addEventListener('DOMContentLoaded', updateFAB);

    // Dynamic fetch and fill
    async function fetchStudentDashboard() {
      const token = localStorage.getItem('studentToken') || localStorage.getItem('token');
      if (!token) {
        // Optionally redirect to login
        document.getElementById('profileName').textContent = 'Please log in';
        return;
      }
      try {
        const res = await fetch('/api/students/me', {
          headers: { 'Authorization': 'Bearer ' + token }
        });
        if (!res.ok) throw new Error('Could not fetch student data');
        const data = await res.json();

        // Profile card
        document.getElementById('profileName').textContent = data.name || 'Student Name';
        document.getElementById('profileMeta').textContent = 'Registration No: ' + (data.reg_no || '-');
        document.getElementById('profileDetails').innerHTML =
          `<span>Class: ${data.class || '-'}</span>` +
          `<span>Session: ${data.session || '-'}</span>` +
          `<span>Term: ${data.term || '-'}</span>`;
        // Avatar
        if (data.photo_url) {
          document.getElementById('profileAvatar').src = data.photo_url;
        } else if (data.name) {
          document.getElementById('profileAvatar').src = 'https://ui-avatars.com/api/?name=' + encodeURIComponent(data.name) + '&background=17c3b2&color=fff';
        }

        // Timetable summary (today)
        if (data.timetable && Array.isArray(data.timetable)) {
          const today = new Date().toLocaleString('en-US', { weekday: 'long' }).toLowerCase();
          const todaySchedule = data.timetable.find(d => (d.day || '').toLowerCase() === today);
          if (todaySchedule && todaySchedule.subjects && todaySchedule.subjects.length > 0) {
            document.getElementById('timetableSummary').innerHTML = todaySchedule.subjects.map(sub =>
              `<div><strong>${sub.time || ''}</strong>: ${sub.name || sub.subject || ''}</div>`
            ).join('');
          } else {
            document.getElementById('timetableSummary').textContent = 'No classes today!';
          }
        } else {
          document.getElementById('timetableSummary').textContent = 'No timetable data.';
        }

        // News & Updates
        if (data.news && data.news.length > 0) {
          document.getElementById('newsContent').innerHTML = data.news.map(news =>
            `<div class="news-item"><strong>${news.title}</strong><br><span style="color:#888;font-size:0.97em;">${news.date || ''}</span><br>${news.summary || ''}</div>`
          ).join('');
        } else {
          document.getElementById('newsContent').textContent = 'No items found';
        }

        // E-Class summary (right panel)
        if (data.eclass_summary && Array.isArray(data.eclass_summary)) {
          document.getElementById('eclassSummary').innerHTML = data.eclass_summary.map(e =>
            `<li><span class="dot"></span> ${e}</li>`
          ).join('');
        }

      } catch (err) {
        document.getElementById('profileName').textContent = 'Unable to load student';
        document.getElementById('profileMeta').textContent = '';
        document.getElementById('profileDetails').innerHTML = '';
        document.getElementById('timetableSummary').textContent = 'Error loading data!';
        document.getElementById('newsContent').textContent = 'Could not fetch news';
      }
    }
    window.addEventListener('DOMContentLoaded', fetchStudentDashboard);
  </script>
</body>
</html>
